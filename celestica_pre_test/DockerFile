# Stage 1: Build
FROM node:18.19.0-alpine3.18 as build

WORKDIR /celestica_pre_test

# Copy package files and install dependenciess
COPY ./package*.json ./
RUN npm ci

# Copy source files and build
COPY ./ ./
RUN npm run build

# Stage 2: Serve with Nginx
FROM nginx:1.23.0-alpine

EXPOSE 8080

# Copy custom nginx config
COPY nginx.conf /etc/nginx/nginx.conf

# âœ… FIX: Copy from correct build output path
COPY --from=build /celestica_pre_test/dist/ngcloudrundemo /usr/share/nginx/html
